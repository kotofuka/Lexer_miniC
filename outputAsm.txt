ORG 8000H
a DB 0
ORG 0
LXI H,0
SPHL
PUSH B
PUSH B
PUSH B
PUSH B
CALL main
END
@MUL
@DIV
@PRINT



func:

	; MOV block
MVI A, 0
LXI H, 6
DAD SP
MOV M, A

	; ADD block
LXI H, 10
DAD SP
MOV A, M
MOV B, A
LXI H, 12
DAD SP
MOV A, M
ADD B
LXI H, 4
DAD SP
MOV M, A

	; MUL block
MVI A, 2
MOV D, A
LXI H, 4
DAD SP
MOV A, M
MOV C, A
	; call black box with op @MULT
PUSH B ; the place for the return value
; PUSH B ; n times (add local vars) and other actions before the call
CALL @MULT
; POP B; n times (delete local vars)
POP B; remove the result
MOV A, C
LXI H, 2
DAD SP
MOV M, A

	; MOV block
LXI H, 2
DAD SP
MOV A, M
LXI H, 6
DAD SP
MOV M, A

	; MOV block
MVI A, 1
LXI H, 0
DAD SP
MOV M, A

	; LT block
LXI H, 10
DAD SP
MOV A, M
MOV B, A
LXI H, 6
DAD SP
MOV A, M
CMP B
JM L0

	; MOV block
MVI A, 0
LXI H, 0
DAD SP
MOV M, A

L0:

	; EQ block
MVI A, 0
MOV B, A
LXI H, 0
DAD SP
MOV A, M
CMP B
JZ L1

	; MOV block
LXI H, 10
DAD SP
MOV A, M
LXI H, 6
DAD SP
MOV M, A
JMP L2

L1:

L2:

	; RET block
LXI H, 6
DAD SP
MOV A, M
LXI H, 8
DAD SP
MOV M, A
POP
POP
POP
POP
RET

	; RET block
MVI A, 0
LXI H, 8
DAD SP
MOV M, A
POP
POP
POP
POP
RET

main:

	; IN block
IN 0
STA a

	; IN block
IN 0
LXI H, 4
DAD SP
MOV M, A

	; CALL block
PUSH B
PUSH B
PUSH B
LDA a
LXI H, 0
DAD SP
MOV M, A
LXI H, 4
DAD SP
MOV A, M
LXI H, 2
DAD SP
MOV M, A
CALL func
POP B
POP B
POP B
MOV A, C
LXI H, 0
DAD SP
MOV M, A

	; MOV block
LXI H, 0
DAD SP
MOV A, M
LXI H, 2
DAD SP
MOV M, A

	; OUT block
LXI H, 2
DAD SP
MOV A, M
OUT 1

	; RET block
MVI A, 0
LXI H, 6
DAD SP
MOV M, A
POP
POP
POP
RET

	; RET block
MVI A, 0
LXI H, 6
DAD SP
MOV M, A
POP
POP
POP
RET

 M, A
POP
POP
POP
RET

MOV M, A
POP
POP
POP
RET
