ORG 8000H
ORG 0
LXI H,0
SPHL
PUSH B
CALL main
END
@MUL
@DIV
@PRINT


fiba:
PUSH B
PUSH B
PUSH B
PUSH B
PUSH B
PUSH B
PUSH B
PUSH B

	; MOV block
MVI A, 1
LXI H, 14
DAD SP
MOV M, A

	; EQ block
MVI A, 0
MOV B, A
LXI H, 18
DAD SP
MOV A, M
CMP B
JZ $L0

	; MOV block
MVI A, 0
LXI H, 14
DAD SP
MOV M, A
$L0:

	; MOV block
MVI A, 1
LXI H, 12
DAD SP
MOV M, A

	; EQ block
MVI A, 1
MOV B, A
LXI H, 18
DAD SP
MOV A, M
CMP B
JZ $L1

	; MOV block
MVI A, 0
LXI H, 12
DAD SP
MOV M, A
$L1:

	; OR block
LXI H, 12
DAD SP
MOV A, M
MOV B, A
LXI H, 14
DAD SP
MOV A, M
ORA B
LXI H, 10
DAD SP
MOV M, A

	; EQ block
MVI A, 0
MOV B, A
LXI H, 10
DAD SP
MOV A, M
CMP B
JZ $L2

	; RET block
MVI A, 1
LXI H, 20
DAD SP
MOV M, A
POP
POP
POP
POP
POP
POP
POP
POP
POP
RET
JMP $L3
$L2:
$L3:

	; SUB block
MVI A, 1
MOV B, A
LXI H, 18
DAD SP
MOV A, M
SUB B
LXI H, 8
DAD SP
MOV M, A

	; CALL block
PUSH B
PUSH B
LXI H, 18
DAD SP
MOV A, M
LXI H, 2
DAD SP
MOV M, A
CALL fiba
POP B
POP B
MOV A, C
LXI H, 6
DAD SP
MOV M, A

	; SUB block
MVI A, 2
MOV B, A
LXI H, 18
DAD SP
MOV A, M
SUB B
LXI H, 4
DAD SP
MOV M, A

	; CALL block
PUSH B
PUSH B
LXI H, 18
DAD SP
MOV A, M
LXI H, 2
DAD SP
MOV M, A
CALL fiba
POP B
POP B
MOV A, C
LXI H, 2
DAD SP
MOV M, A

	; ADD block
LXI H, 2
DAD SP
MOV A, M
MOV B, A
LXI H, 6
DAD SP
MOV A, M
ADD B
LXI H, 0
DAD SP
MOV M, A

	; RET block
LXI H, 0
DAD SP
MOV A, M
LXI H, 20
DAD SP
MOV M, A
POP
POP
POP
POP
POP
POP
POP
POP
POP
RET

	; RET block
MVI A, 0
LXI H, 20
DAD SP
MOV M, A
POP
POP
POP
POP
POP
POP
POP
POP
POP
RET
main:
PUSH B
PUSH B
PUSH B
PUSH B
PUSH B
PUSH B

	; IN block
IN 0
LXI H, 10
DAD SP
MOV M, A

	; MOV block
MVI A, 13
LXI H, 6
DAD SP
MOV M, A

	; MOV block
MVI A, 0
LXI H, 6
DAD SP
MOV M, A
$L4:

	; MOV block
MVI A, 1
LXI H, 4
DAD SP
MOV M, A

	; LT block
LXI H, 10
DAD SP
MOV A, M
MOV B, A
LXI H, 6
DAD SP
MOV A, M
CMP B
JM $L8

	; MOV block
MVI A, 0
LXI H, 4
DAD SP
MOV M, A
$L8:

	; EQ block
MVI A, 0
MOV B, A
LXI H, 4
DAD SP
MOV A, M
CMP B
JZ $L7
JMP $L6
$L5:

	; ADD block
MVI A, 1
MOV B, A
LXI H, 6
DAD SP
MOV A, M
ADD B
LXI H, 6
DAD SP
MOV M, A
JMP $L4
$L6:

	; MOV block
MVI A, 0
LXI H, 2
DAD SP
MOV M, A

	; CALL block
PUSH B
PUSH B
LXI H, 18
DAD SP
MOV A, M
LXI H, 2
DAD SP
MOV M, A
CALL fiba
POP B
POP B
MOV A, C
LXI H, 0
DAD SP
MOV M, A

	; MOV block
LXI H, 0
DAD SP
MOV A, M
LXI H, 8
DAD SP
MOV M, A

	; OUT block
LXI H, 8
DAD SP
MOV A, M
OUT 1
JMP $L5
$L7:

	; OUT block
LXI H, 8
DAD SP
MOV A, M
OUT 1

	; RET block
MVI A, 0
LXI H, 14
DAD SP
MOV M, A
POP
POP
POP
POP
POP
POP
RET
